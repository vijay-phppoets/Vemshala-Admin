{"ast":null,"code":"import _defineProperty from\"/home/kuldeep/Git Hub/Vemshala-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/kuldeep/Git Hub/Vemshala-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/kuldeep/Git Hub/Vemshala-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/kuldeep/Git Hub/Vemshala-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/kuldeep/Git Hub/Vemshala-Admin/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{Form,Input,Row,Col,TreeSelect,Button,message,InputNumber,Divider,Popconfirm,Table}from\"antd\";import{Redirect}from\"react-router-dom\";import{connect}from\"react-redux\";import{v4 as uuidv4}from'uuid';import axios from'axios';import{DeleteOutlined}from\"@ant-design/icons\";/* custom component */import Header from\"../../component/Header/Header\";import{PageContainer}from\"../../component/Xcomponent\";/* action */import{saveTestimonial as _saveTestimonial,saveTestimonialReset as _saveTestimonialReset}from\"../../action/saveTestimonialAction\";import{getTestimonialList as _getTestimonialList,getTestimonialListReset as _getTestimonialListReset}from\"../../action/getTestimonialListAction\";import{delTestimonial as _delTestimonial,delTestimonialReset as _delTestimonialReset}from\"../../action/delTestimonialAction\";/* others */import{validateImageFile,getS3SingedUrl}from\"../../utils\";import cnf from\"../../config\";var Testimonial=function Testimonial(props){/* variables */var saveTestimonial=props.saveTestimonial,saveTestimonialReset=props.saveTestimonialReset,saveTestimonialState=props.saveTestimonialState,getTestimonialList=props.getTestimonialList,getTestimonialListReset=props.getTestimonialListReset,getTestimonialListState=props.getTestimonialListState,delTestimonial=props.delTestimonial,delTestimonialReset=props.delTestimonialReset,delTestimonialState=props.delTestimonialState;var initial_values={description:\"\",image:\"\",name:\"\",title:\"\",sequence:1};var _useState=useState(initial_values),_useState2=_slicedToArray(_useState,2),formData=_useState2[0],setFormData=_useState2[1];var _useState3=useState([false,'']),_useState4=_slicedToArray(_useState3,2),redirect=_useState4[0],setRedirect=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),image=_useState6[0],set_image=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),submitLoading=_useState8[0],setSubmitLoading=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),refresh=_useState10[0],setRefresh=_useState10[1];var columns=[{title:'Description',dataIndex:'description',key:'description'},{title:'Image',dataIndex:'image',key:'image',render:function render(image){return/*#__PURE__*/React.createElement(\"img\",{src:\"\".concat(cnf.s3_base_url).concat(image),alt:\"\",style:{width:50}});}},{title:'Name',dataIndex:'name',key:'name'},{title:'Title',dataIndex:'title',key:'title'},{title:'Action',dataIndex:'id',key:'action',render:function render(id){return/*#__PURE__*/React.createElement(Popconfirm,{title:\"Are you sure to delete this testimonial?\",onConfirm:function onConfirm(){return delTestimonial({id:id});},okText:\"Delete\",cancelText:\"Cancel\",okType:\"danger\"},/*#__PURE__*/React.createElement(Button,{size:\"small\",icon:/*#__PURE__*/React.createElement(DeleteOutlined,null)}));}}];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),tableData=_useState12[0],setTableData=_useState12[1];var _Form$useForm=Form.useForm(),_Form$useForm2=_slicedToArray(_Form$useForm,1),form=_Form$useForm2[0];/* callbakcs */useEffect(function(){return function(){saveTestimonialReset();getTestimonialListReset();delTestimonialReset();};},[]);useEffect(function(){getTestimonialList();},[refresh]);useEffect(function(){if(saveTestimonialState.apiState===\"success\"){setRefresh(refresh+1);form.resetFields();setFormData(initial_values);setSubmitLoading(false);message.success(saveTestimonialState.message);}if(saveTestimonialState.apiState===\"error\"){saveTestimonialReset();setSubmitLoading(false);message.error(saveTestimonialState.message);}},[saveTestimonialState]);useEffect(function(){if(delTestimonialState.apiState===\"success\"){setRefresh(refresh+1);message.success(delTestimonialState.message);}if(delTestimonialState.apiState===\"error\"){delTestimonialReset();message.error(delTestimonialState.message);}},[delTestimonialState]);useEffect(function(){if(getTestimonialListState.apiState===\"success\"){var ar=[];getTestimonialListState.list.map(function(obj){ar.push({key:obj.id,description:obj.description,image:obj.image,name:obj.name,title:obj.title,id:obj.id});});setTableData(ar);}},[getTestimonialListState]);/* functions */var handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var image_filename,imageValRes,s3UrlRes;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!image){_context.next=6;break;}image_filename=uuidv4();imageValRes=validateImageFile(image);if(imageValRes.status){_context.next=6;break;}alert(\"Image's extension is not allowed.\");return _context.abrupt(\"return\");case 6:setSubmitLoading(true);if(!image){_context.next=14;break;}_context.next=10;return getS3SingedUrl(image_filename,imageValRes.ext,image);case 10:s3UrlRes=_context.sent;_context.next=13;return axios.put(s3UrlRes.url,image);case 13:formData.image=\"\".concat(image_filename,\".\").concat(imageValRes.ext);case 14:saveTestimonial(formData);case 15:case\"end\":return _context.stop();}}},_callee);}));return function handleSubmit(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(React.Fragment,null,redirect[0]&&/*#__PURE__*/React.createElement(Redirect,{to:redirect[1]}),/*#__PURE__*/React.createElement(Header,{title:\"Home Page Testimonials\"}),/*#__PURE__*/React.createElement(PageContainer,null,/*#__PURE__*/React.createElement(Form,{form:form,layout:\"vertical\",onFinish:handleSubmit},/*#__PURE__*/React.createElement(Row,{gutter:\"24\"},/*#__PURE__*/React.createElement(Col,{span:\"8\"},/*#__PURE__*/React.createElement(Form.Item,{label:\"Description\",name:\"description\",rules:[{required:true,message:'Required'}]},/*#__PURE__*/React.createElement(Input.TextArea,{name:\"description\",placeholder:\"Enter Description\",onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},_defineProperty({},'description',e.target.value)));}}))),/*#__PURE__*/React.createElement(Col,{span:\"8\"},/*#__PURE__*/React.createElement(Form.Item,{label:\"Image\",name:\"image\",extra:/*#__PURE__*/React.createElement(\"span\",null,\"JPEG, JPG, PNG, WEBP | 1:1 Ratio  \")},/*#__PURE__*/React.createElement(Input,{type:\"file\",name:\"image\",onChange:function onChange(e){return set_image(e.target.files[0]);}}))),/*#__PURE__*/React.createElement(Col,{span:\"8\"},/*#__PURE__*/React.createElement(Form.Item,{label:\"Name\",name:\"name\",rules:[{required:true,message:'Required'}]},/*#__PURE__*/React.createElement(Input,{name:\"name\",placeholder:\"Enter Name\",onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},_defineProperty({},'name',e.target.value)));}}))),/*#__PURE__*/React.createElement(Col,{span:\"8\"},/*#__PURE__*/React.createElement(Form.Item,{label:\"Title\",name:\"title\"},/*#__PURE__*/React.createElement(Input,{name:\"title\",placeholder:\"Enter Title\",onChange:function onChange(e){return setFormData(_objectSpread(_objectSpread({},formData),{},_defineProperty({},'title',e.target.value)));}}))),/*#__PURE__*/React.createElement(Col,{span:\"4\"},/*#__PURE__*/React.createElement(Form.Item,{label:\"Sequence\",name:\"sequence\"},/*#__PURE__*/React.createElement(InputNumber,{name:\"sequence\",placeholder:\"Enter Sequence\",style:{width:\"100%\"},onChange:function onChange(v){return setFormData(_objectSpread(_objectSpread({},formData),{},_defineProperty({},'sequence',v)));}})))),/*#__PURE__*/React.createElement(Button,{type:\"primary\",htmlType:\"submit\",loading:submitLoading},\"SUBMIT\")),/*#__PURE__*/React.createElement(Divider,null),/*#__PURE__*/React.createElement(Table,{dataSource:tableData,columns:columns,size:\"small\",pagination:false})));};var mapStateToProps=function mapStateToProps(state){return{saveTestimonialState:state.saveTestimonial,getTestimonialListState:state.getTestimonialList,delTestimonialState:state.delTestimonial};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{saveTestimonial:function saveTestimonial(params){return dispatch(_saveTestimonial(params));},saveTestimonialReset:function saveTestimonialReset(){return dispatch(_saveTestimonialReset());},getTestimonialList:function getTestimonialList(params){return dispatch(_getTestimonialList(params));},getTestimonialListReset:function getTestimonialListReset(){return dispatch(_getTestimonialListReset());},delTestimonial:function delTestimonial(params){return dispatch(_delTestimonial(params));},delTestimonialReset:function delTestimonialReset(){return dispatch(_delTestimonialReset());}};};export default connect(mapStateToProps,mapDispatchToProps)(Testimonial);","map":{"version":3,"sources":["/home/kuldeep/Git Hub/Vemshala-Admin/src/page/Testimonial/Testimonial.js"],"names":["React","useState","useEffect","Form","Input","Row","Col","TreeSelect","Button","message","InputNumber","Divider","Popconfirm","Table","Redirect","connect","v4","uuidv4","axios","DeleteOutlined","Header","PageContainer","saveTestimonial","saveTestimonialReset","getTestimonialList","getTestimonialListReset","delTestimonial","delTestimonialReset","validateImageFile","getS3SingedUrl","cnf","Testimonial","props","saveTestimonialState","getTestimonialListState","delTestimonialState","initial_values","description","image","name","title","sequence","formData","setFormData","redirect","setRedirect","set_image","submitLoading","setSubmitLoading","refresh","setRefresh","columns","dataIndex","key","render","s3_base_url","width","id","tableData","setTableData","useForm","form","apiState","resetFields","success","error","ar","list","map","obj","push","handleSubmit","image_filename","imageValRes","status","alert","ext","s3UrlRes","put","url","required","e","target","value","files","v","mapStateToProps","state","mapDispatchToProps","dispatch","params"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\"\nimport { Form, Input, Row, Col, TreeSelect, Button, message, InputNumber, Divider, Popconfirm, Table } from \"antd\"\nimport { Redirect } from \"react-router-dom\"\nimport { connect } from \"react-redux\"\nimport { v4 as uuidv4 } from 'uuid'\nimport axios from 'axios'\nimport { DeleteOutlined } from \"@ant-design/icons\"\n\n\n/* custom component */\nimport Header from \"../../component/Header/Header\"\nimport { PageContainer } from \"../../component/Xcomponent\"\n\n\n/* action */\nimport { saveTestimonial, saveTestimonialReset } from \"../../action/saveTestimonialAction\"\nimport { getTestimonialList, getTestimonialListReset } from \"../../action/getTestimonialListAction\"\nimport { delTestimonial, delTestimonialReset } from \"../../action/delTestimonialAction\"\n\n\n/* others */\nimport { validateImageFile, getS3SingedUrl } from \"../../utils\"\nimport cnf from \"../../config\"\n\nconst Testimonial = props => {\n    /* variables */\n    const {\n        saveTestimonial, saveTestimonialReset, saveTestimonialState,\n        getTestimonialList, getTestimonialListReset, getTestimonialListState,\n        delTestimonial, delTestimonialReset, delTestimonialState,\n    } = props\n    const initial_values = {\n        description: \"\",\n        image: \"\",\n        name: \"\",\n        title: \"\",\n        sequence: 1,\n    }\n    const [formData, setFormData] = useState(initial_values)\n    const [redirect, setRedirect] = useState([false, ''])\n    const [image, set_image] = useState(null)\n    const [submitLoading, setSubmitLoading] = useState(false)\n    const [refresh, setRefresh] = useState(0)\n    const columns = [\n        {\n            title: 'Description',\n            dataIndex: 'description',\n            key: 'description',\n        },\n        {\n            title: 'Image',\n            dataIndex: 'image',\n            key: 'image',\n            render: (image) => (<img src={`${cnf.s3_base_url}${image}`} alt=\"\" style={{ width: 50 }} />)\n        },\n        {\n            title: 'Name',\n            dataIndex: 'name',\n            key: 'name',\n        },\n        {\n            title: 'Title',\n            dataIndex: 'title',\n            key: 'title',\n        },\n        {\n            title: 'Action',\n            dataIndex: 'id',\n            key: 'action',\n            render: (id) => (\n                <Popconfirm\n                    title=\"Are you sure to delete this testimonial?\"\n                    onConfirm={() => delTestimonial({\n                        id: id,\n                    })}\n                    okText=\"Delete\"\n                    cancelText=\"Cancel\"\n                    okType=\"danger\"\n                >\n                    <Button size=\"small\" icon={<DeleteOutlined />} />\n                </Popconfirm>\n            )\n        }\n    ];\n    const [tableData, setTableData] = useState([])\n    const [form] = Form.useForm()\n\n    /* callbakcs */\n    useEffect(() => {\n        return (() => {\n            saveTestimonialReset()\n            getTestimonialListReset()\n            delTestimonialReset()\n        })\n    }, [])\n\n    useEffect(() => {\n        getTestimonialList()\n    }, [refresh])\n\n    useEffect(() => {\n        if (saveTestimonialState.apiState === \"success\") {\n            setRefresh(refresh + 1)\n            form.resetFields()\n            setFormData(initial_values)\n            setSubmitLoading(false)\n            message.success(saveTestimonialState.message);\n        }\n\n        if (saveTestimonialState.apiState === \"error\") {\n            saveTestimonialReset()\n            setSubmitLoading(false)\n            message.error(saveTestimonialState.message);\n        }\n    }, [saveTestimonialState])\n\n\n    useEffect(() => {\n        if (delTestimonialState.apiState === \"success\") {\n            setRefresh(refresh + 1)\n            message.success(delTestimonialState.message);\n        }\n\n        if (delTestimonialState.apiState === \"error\") {\n            delTestimonialReset()\n            message.error(delTestimonialState.message);\n        }\n    }, [delTestimonialState])\n\n    useEffect(() => {\n        if (getTestimonialListState.apiState === \"success\") {\n            let ar = []\n            getTestimonialListState.list.map(obj => {\n                ar.push({\n                    key: obj.id,\n                    description: obj.description,\n                    image: obj.image,\n                    name: obj.name,\n                    title: obj.title,\n                    id: obj.id,\n                })\n            })\n            setTableData(ar)\n        }\n    }, [getTestimonialListState])\n\n    /* functions */\n    const handleSubmit = async () => {\n        let image_filename\n        let imageValRes\n        if (image) {\n            image_filename = uuidv4()\n            imageValRes = validateImageFile(image)\n            if (!imageValRes.status) {\n                alert(\"Image's extension is not allowed.\")\n                return\n            }\n        }\n\n\n        setSubmitLoading(true)\n\n        if (image) {\n            let s3UrlRes = await getS3SingedUrl(image_filename, imageValRes.ext, image)\n            await axios.put(s3UrlRes.url, image)\n\n            formData.image = `${image_filename}.${imageValRes.ext}`\n        }\n\n        saveTestimonial(formData)\n    }\n\n\n\n    return (\n        <>\n            {redirect[0] &&\n                <Redirect to={redirect[1]} />}\n\n            <Header\n                title=\"Home Page Testimonials\"\n            />\n            <PageContainer>\n\n                <Form form={form} layout=\"vertical\" onFinish={handleSubmit} >\n                    <Row gutter=\"24\" >\n                        <Col span=\"8\">\n                            <Form.Item\n                                label=\"Description\"\n                                name=\"description\"\n                                rules={[{ required: true, message: 'Required' }]}\n                            >\n                                <Input.TextArea name=\"description\" placeholder=\"Enter Description\"\n                                    onChange={e => setFormData({ ...formData, ['description']: e.target.value })}\n                                />\n                            </Form.Item>\n                        </Col>\n                        <Col span=\"8\">\n                            <Form.Item\n                                label=\"Image\"\n                                name=\"image\"\n                                extra={<span>JPEG, JPG, PNG, WEBP | 1:1 Ratio  </span>}\n                            >\n                                <Input type=\"file\" name=\"image\"\n                                    onChange={e => set_image(e.target.files[0])}\n                                />\n                            </Form.Item>\n                        </Col>\n                        <Col span=\"8\">\n                            <Form.Item\n                                label=\"Name\"\n                                name=\"name\"\n                                rules={[{ required: true, message: 'Required' }]}\n                            >\n                                <Input name=\"name\" placeholder=\"Enter Name\"\n                                    onChange={e => setFormData({ ...formData, ['name']: e.target.value })}\n                                />\n                            </Form.Item>\n                        </Col>\n                        <Col span=\"8\">\n                            <Form.Item\n                                label=\"Title\"\n                                name=\"title\"\n                            >\n                                <Input name=\"title\" placeholder=\"Enter Title\"\n                                    onChange={e => setFormData({ ...formData, ['title']: e.target.value })}\n                                />\n                            </Form.Item>\n                        </Col>\n                        <Col span=\"4\">\n                            <Form.Item\n                                label=\"Sequence\"\n                                name=\"sequence\"\n                            >\n                                <InputNumber name=\"sequence\" placeholder=\"Enter Sequence\"\n                                    style={{ width: \"100%\" }}\n                                    onChange={v => setFormData({ ...formData, ['sequence']: v })}\n                                />\n                            </Form.Item>\n                        </Col>\n                    </Row>\n                    <Button type=\"primary\" htmlType=\"submit\" loading={submitLoading} >SUBMIT</Button>\n                </Form>\n\n                <Divider />\n                <Table dataSource={tableData} columns={columns} size=\"small\" pagination={false} />\n            </PageContainer>\n        </>\n    )\n}\n\nconst mapStateToProps = (state) => ({\n    saveTestimonialState: state.saveTestimonial,\n    getTestimonialListState: state.getTestimonialList,\n    delTestimonialState: state.delTestimonial,\n})\n\nconst mapDispatchToProps = (dispatch) => ({\n    saveTestimonial: (params) => dispatch(saveTestimonial(params)),\n    saveTestimonialReset: () => dispatch(saveTestimonialReset()),\n    getTestimonialList: (params) => dispatch(getTestimonialList(params)),\n    getTestimonialListReset: () => dispatch(getTestimonialListReset()),\n    delTestimonial: (params) => dispatch(delTestimonial(params)),\n    delTestimonialReset: () => dispatch(delTestimonialReset()),\n})\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Testimonial)"]},"metadata":{},"sourceType":"module"}